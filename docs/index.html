<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SuperF: Neural Implicit Fields for Multi-Image Super-Resolution. Test-time optimization for satellite and handheld bursts.">
    <title>SuperF: Neural Implicit Fields for Multi-Image Super-Resolution</title>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* --- CORE STYLES --- */
        :root {
            --primary: #1a1a1a;
            --secondary: #4a5d72;
            --accent: #274060;
            --highlight: #3b82f6;
            --danger: #ef4444; /* For Uncertainty */
            --bg-light: #f8f9fa;
            --text-main: #333;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: var(--text-main);
            background-color: #fff;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 1180px;
            margin: 0 auto;
            padding: 0 20px 80px;
        }

        section {
            margin: 100px 0;
            scroll-margin-top: 80px;
        }

        h1 {
            font-size: clamp(40px, 6vw, 64px);
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 24px;
            letter-spacing: -0.03em;
            line-height: 1.1;
        }

        h2 {
            font-size: 36px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 40px;
            letter-spacing: -0.02em;
            text-align: center;
        }

        h3 {
            font-size: 24px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 16px;
        }

        p {
            font-size: 18px;
            color: #4b5563;
            margin-bottom: 24px;
            line-height: 1.75;
            max-width: 75ch;
            margin-left: auto;
            margin-right: auto;
        }

        /* --- HERO SECTION --- */
        .hero {
            position: relative;
            border-radius: 24px;
            background: radial-gradient(circle at 0% 0%, rgba(59, 130, 246, 0.1), transparent 40%),
                        radial-gradient(circle at 100% 100%, rgba(246, 114, 128, 0.1), transparent 40%),
                        linear-gradient(180deg, #f8fbff 0%, #ffffff 100%);
            padding: 60px 50px;
            margin-top: 40px;
            border: 1px solid rgba(0,0,0,0.03);
            text-align: center;
        }

        .hero-inner {
            max-width: 900px;
            margin: 0 auto;
        }

        .hero-text {
            width: 100%;
        }

        .hero h1 {
            margin-bottom: 16px;
        }

        .tagline {
            font-size: 22px;
            font-weight: 500;
            color: var(--accent);
            margin-bottom: 20px;
        }

        .authors {
            font-size: 16px;
            color: #4b5563;
            margin-bottom: 6px;
            line-height: 1.5;
        }
        
        .authors a {
            color: inherit;
            text-decoration: none;
            border-bottom: 1px solid rgba(59, 130, 246, 0.3);
            transition: all 0.2s ease;
        }
        
        .authors a:hover {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .affiliations {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .links {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-top: 32px;
            justify-content: center;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            padding: 12px 28px;
            background-color: var(--primary);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 500;
            transition: transform 0.2s, background-color 0.2s;
        }
        
        .btn:hover { background-color: #000; transform: translateY(-2px); }
        
        .btn.secondary {
            background-color: white;
            color: var(--primary);
            border: 1px solid #e5e7eb;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        
        .btn.secondary:hover { background-color: #f9fafb; border-color: #d1d5db; }

        .btn.disabled {
            background-color: #e5e7eb;
            color: #9ca3af;
            border-color: #e5e7eb;
            cursor: default;
            box-shadow: none;
            pointer-events: none;
        }

        .method-toggle-btn.active {
            background-color: var(--primary) !important;
            color: white !important;
            border-color: var(--primary) !important;
        }
        
        .method-toggle-btn:hover:not(.active),
        .sequence-view-toggle:hover:not(.active) {
            background-color: #f9fafb !important;
            border-color: #d1d5db !important;
        }
        
        .slider-divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 36px;
            height: 36px;
            background: white;
            border: 3px solid var(--primary);
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.25);
        }
        
        .slider-container {
            aspect-ratio: 1;
        }
        
        .slider-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .slider-lr {
            /* Force pixelated/nearest-neighbor scaling instead of bilinear */
            image-rendering: -moz-crisp-edges;
            image-rendering: -webkit-crisp-edges;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }

        #uncertainty-prev:hover, #uncertainty-next:hover,
        #qualitative-prev:hover, #qualitative-next:hover {
            background: var(--primary) !important;
            color: white !important;
            transform: translateY(-50%) scale(1.1);
        }

        .hero-media {
            border-radius: 16px;
            overflow: visible;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* --- ANIMATION 1: JITTERING FRAMES --- */
        .alignment-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            height: 350px;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #f8f9fa;
            border-radius: 16px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
            overflow: hidden;
        }

        /* Hero-specific styling */
        .hero .alignment-container {
            height: 400px;
            box-shadow: 0 12px 32px rgba(0,0,0,0.15);
        }

        /* Side-by-side examples container */
        .examples-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 40px;
            margin: 40px 0;
            align-items: start;
        }

        .example-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .example-item .alignment-container {
            max-width: 100%;
            width: 100%;
        }

        .example-label {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .jitter-frame {
            position: absolute;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            border-radius: 8px;
            opacity: 0.4;
            mix-blend-mode: normal;
            image-rendering: pixelated;
            background-color: #e5e7eb; /* Fallback if image doesn't load */
        }

        /* Individual jittering frames with different offsets */
        .jitter-frame-1 {
            animation: jitter1 6s infinite linear, switchImage1 6s infinite linear;
            z-index: 1;
        }

        .jitter-frame-2 {
            animation: jitter2 6s infinite linear, switchImage2 6s infinite linear;
            z-index: 2;
            animation-delay: 0.15s;
        }

        .jitter-frame-3 {
            animation: jitter3 6s infinite linear, switchImage3 6s infinite linear;
            z-index: 3;
            animation-delay: 0.3s;
        }

        /* Island example frames - each uses a different LR image */
        .island-frame-1 {
            animation: jitter1 6s infinite linear, switchIslandImage1 6s infinite linear;
            z-index: 1;
        }

        .island-frame-2 {
            animation: jitter2 6s infinite linear, switchIslandImage2 6s infinite linear;
            z-index: 2;
            animation-delay: 0.15s;
        }

        .island-frame-3 {
            animation: jitter3 6s infinite linear, switchIslandImage3 6s infinite linear;
            z-index: 3;
            animation-delay: 0.3s;
        }

        @keyframes jitter1 {
            0% { 
                transform: translate(15px, 8px) rotate(0.4deg); 
            }
            30% { 
                transform: translate(0px, 0px) rotate(0deg); 
            }
            50% { 
                transform: translate(0px, 0px) rotate(0deg); 
            }
            80% { 
                transform: translate(-15px, 8px) rotate(-0.4deg); 
            }
            100% { 
                transform: translate(15px, 8px) rotate(0.4deg); 
            }
        }

        @keyframes jitter2 {
            0% { 
                transform: translate(-8px, 15px) rotate(-0.3deg); 
            }
            30% { 
                transform: translate(0px, 0px) rotate(0deg); 
            }
            50% { 
                transform: translate(0px, 0px) rotate(0deg); 
            }
            80% { 
                transform: translate(8px, -15px) rotate(0.3deg); 
            }
            100% { 
                transform: translate(-8px, 15px) rotate(-0.3deg); 
            }
        }

        @keyframes jitter3 {
            0% { 
                transform: translate(-10px, -12px) rotate(0.5deg); 
            }
            30% { 
                transform: translate(0px, 0px) rotate(0deg); 
            }
            50% { 
                transform: translate(0px, 0px) rotate(0deg); 
            }
            80% { 
                transform: translate(10px, 12px) rotate(-0.5deg); 
            }
            100% { 
                transform: translate(-10px, -12px) rotate(0.5deg); 
            }
        }

        /* Switch between LR and HR images */
        @keyframes switchImage1 {
            0%, 25% { 
                background-image: url('figs/kjevik_lr.png'); 
                filter: blur(1.5px); 
            }
            30% { 
                background-image: url('figs/kjevik_hr.png'); 
                filter: blur(0px); 
            }
            50% { 
                background-image: url('figs/kjevik_hr.png'); 
                filter: blur(0px); 
            }
            55%, 100% { 
                background-image: url('figs/kjevik_lr.png'); 
                filter: blur(1.5px); 
            }
        }

        @keyframes switchImage2 {
            0%, 25% { 
                background-image: url('figs/kjevik_lr.png'); 
                filter: blur(1.5px); 
            }
            30% { 
                background-image: url('figs/kjevik_hr.png'); 
                filter: blur(0px); 
            }
            50% { 
                background-image: url('figs/kjevik_hr.png'); 
                filter: blur(0px); 
            }
            55%, 100% { 
                background-image: url('figs/kjevik_lr.png'); 
                filter: blur(1.5px); 
            }
        }

        @keyframes switchImage3 {
            0%, 25% { 
                background-image: url('figs/kjevik_lr.png'); 
                filter: blur(1.5px); 
            }
            30% { 
                background-image: url('figs/kjevik_hr.png'); 
                filter: blur(0px); 
            }
            50% { 
                background-image: url('figs/kjevik_hr.png'); 
                filter: blur(0px); 
            }
            55%, 100% { 
                background-image: url('figs/kjevik_lr.png'); 
                filter: blur(1.5px); 
            }
        }

        /* Island example image switching */
        @keyframes switchIslandImage1 {
            0%, 25% { 
                background-image: url('figs/island/LR_1.png'); 
                filter: blur(1.5px); 
            }
            30% { 
                background-image: url('figs/island/HR.png'); 
                filter: blur(0px); 
            }
            50% { 
                background-image: url('figs/island/HR.png'); 
                filter: blur(0px); 
            }
            55%, 100% { 
                background-image: url('figs/island/LR_1.png'); 
                filter: blur(1.5px); 
            }
        }

        @keyframes switchIslandImage2 {
            0%, 25% { 
                background-image: url('figs/island/LR_2.png'); 
                filter: blur(1.5px); 
            }
            30% { 
                background-image: url('figs/island/HR.png'); 
                filter: blur(0px); 
            }
            50% { 
                background-image: url('figs/island/HR.png'); 
                filter: blur(0px); 
            }
            55%, 100% { 
                background-image: url('figs/island/LR_2.png'); 
                filter: blur(1.5px); 
            }
        }

        @keyframes switchIslandImage3 {
            0%, 25% { 
                background-image: url('figs/island/LR_3.png'); 
                filter: blur(1.5px); 
            }
            30% { 
                background-image: url('figs/island/HR.png'); 
                filter: blur(0px); 
            }
            50% { 
                background-image: url('figs/island/HR.png'); 
                filter: blur(0px); 
            }
            55%, 100% { 
                background-image: url('figs/island/LR_3.png'); 
                filter: blur(1.5px); 
            }
        }

        /* --- ANIMATION 2: 3D BURST STACK (Method Section) --- */
        .stack-container {
            perspective: 1200px;
            height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin: 30px 0;
            overflow: visible;
            position: relative;
        }

        .stack-scene {
            position: relative;
            width: 250px; 
            height: 250px;
            transform-style: preserve-3d;
            transform: rotateX(60deg) rotateZ(-30deg);
            transition: transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .stack-container:hover .stack-scene {
            transform: rotateX(50deg) rotateZ(-20deg) scale(1.15);
        }

        .layer {
            position: absolute;
            width: 100%; 
            height: 100%;
            background-size: cover;
            background-position: center;
            border-radius: 8px;
            box-shadow: -5px 5px 10px rgba(0,0,0,0.1);
            transition: all 0.5s ease;
            cursor: pointer;
        }

        .layer.lr {
            background-image: url('figs/kjevik_lr.png'); 
            background-color: #ddd; 
            border: 2px solid rgba(255,255,255,0.8);
            image-rendering: pixelated;
        }

        .layer.hr {
            background-image: url('figs/kjevik_hr.png'); 
            background-color: var(--accent); 
            border: 3px solid var(--highlight);
            box-shadow: 0 0 25px rgba(59, 130, 246, 0.4);
            bottom: 0;
            z-index: 50;
        }

        .layer:nth-child(1) { 
            transform: translateZ(0px); 
        }
        .layer:nth-child(2) { 
            animation: alignLayer1 2.8s ease-in-out infinite; 
        }
        .layer:nth-child(3) { 
            animation: alignLayer2 2.8s ease-in-out infinite; 
        }
        .layer:nth-child(4) { 
            animation: alignLayer3 2.8s ease-in-out infinite; 
        }


        @keyframes alignLayer1 {
            0%, 30% { 
                transform: translateZ(60px) translateX(-40px) translateY(-30px) rotate(-3deg); 
                opacity: 0.4; 
            }
            50% { 
                transform: translateZ(60px) translateX(0px) translateY(0px) rotate(0deg); 
                opacity: 0.75; 
            }
            60% { 
                transform: translateZ(60px) translateX(0px) translateY(0px) rotate(0deg); 
                opacity: 0.75; 
            }
            100% { 
                transform: translateZ(60px) translateX(-40px) translateY(-30px) rotate(-3deg); 
                opacity: 0.4; 
            }
        }

        @keyframes alignLayer2 {
            0%, 30% { 
                transform: translateZ(120px) translateX(35px) translateY(30px) rotate(3deg); 
                opacity: 0.35; 
            }
            50% { 
                transform: translateZ(120px) translateX(0px) translateY(0px) rotate(0deg); 
                opacity: 0.6; 
            }
            60% { 
                transform: translateZ(120px) translateX(0px) translateY(0px) rotate(0deg); 
                opacity: 0.6; 
            }
            100% { 
                transform: translateZ(120px) translateX(35px) translateY(30px) rotate(3deg); 
                opacity: 0.35; 
            }
        }

        @keyframes alignLayer3 {
            0%, 30% { 
                transform: translateZ(180px) translateX(-30px) translateY(35px) rotate(-2.5deg); 
                opacity: 0.3; 
            }
            50% { 
                transform: translateZ(180px) translateX(0px) translateY(0px) rotate(0deg); 
                opacity: 0.45; 
            }
            60% { 
                transform: translateZ(180px) translateX(0px) translateY(0px) rotate(0deg); 
                opacity: 0.45; 
            }
            100% { 
                transform: translateZ(180px) translateX(-30px) translateY(35px) rotate(-2.5deg); 
                opacity: 0.3; 
            }
        }

        /* Layer labels */
        .layer-label {
            position: absolute;
            font-size: 11px;
            font-weight: 600;
            color: white;
            background: rgba(0,0,0,0.75);
            padding: 5px 10px;
            border-radius: 6px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            white-space: nowrap;
            backdrop-filter: blur(4px);
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .stack-container:hover .layer-label {
            opacity: 1;
        }

        .layer-label.hr-label {
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(59, 130, 246, 0.9);
        }

        .layer-label.lr-label {
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
        }

        /* --- TIMELAPSE ANIMATION --- */
        .timelapse-container {
            max-width: 500px;
            margin: 60px auto;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            border: 4px solid white;
            background: #000;
            position: relative;
            display: inline-block;
            line-height: 0;
        }

        .timelapse-frame {
            display: block;
            width: auto;
            height: auto;
            max-width: 100%;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .timelapse-frame.loaded {
            opacity: 1;
        }

        .timelapse-controls {
            max-width: 1000px;
            margin: 20px auto 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .timelapse-slider {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: #e5e7eb;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .timelapse-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--highlight);
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .timelapse-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--highlight);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .timelapse-frame-info {
            font-size: 14px;
            color: #6b7280;
            min-width: 80px;
            text-align: right;
        }

        .timelapse-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .timelapse-option {
            cursor: pointer;
            border: 3px solid transparent;
            border-radius: 12px;
            padding: 8px;
            background: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .timelapse-option:hover {
            box-shadow: 0 6px 16px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }

        .timelapse-option.active {
            border-color: var(--highlight);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
        }

        .timelapse-preview {
            width: 120px;
            height: 120px;
            object-fit: contain;
            border-radius: 8px;
            background: #000;
        }

        .timelapse-option-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary);
        }

        /* --- SHARED LENS STYLES --- */
        .lens-wrapper {
            position: relative;
            max-width: 800px;
            margin: 40px auto;
            border-radius: 12px;
            overflow: hidden;
            cursor: crosshair;
            box-shadow: 0 20px 40px -5px rgba(0,0,0,0.2);
            border: 4px solid white;
        }

        .img-base {
            display: block;
            width: 100%;
            height: auto;
            filter: blur(1px) grayscale(0.2); 
            transition: filter 0.3s;
        }

        .lens-wrapper:hover .img-base {
            filter: blur(2px) grayscale(0.4);
        }

        .lens {
            position: absolute;
            width: 280px; height: 280px;
            border-radius: 50%;
            border: 3px solid #fff;
            
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
            background-repeat: no-repeat;
            background-size: cover; /* Will be overwritten by JS */
            
            display: none;
            pointer-events: none;
            z-index: 100;
        }

        .lens-hint {
            position: absolute;
            top: 20px; left: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            pointer-events: none;
            backdrop-filter: blur(4px);
        }

        /* Specific styles for Uncertainty Lens */
        .uncertainty-lens {
            border-color: var(--danger); /* Red border to signify "alert" */
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.4);
        }
        
        .uncertainty-img {
            /* Simulates a heatmap if you don't have the exact image yet. 
               Remove this filter if your 'figs/uncertainty_map.png' is already a colored heatmap. */
            filter: invert(1) hue-rotate(180deg) contrast(1.5); 
        }

        /* --- METRICS & MATH --- */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 24px;
            margin-bottom: 60px;
        }

        .metric-card {
            background: #fff;
            padding: 32px 24px;
            border-radius: 16px;
            border: 1px solid #e5e7eb;
            text-align: center;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
        }

        .metric-val { font-size: 42px; font-weight: 800; color: var(--primary); line-height: 1; margin-bottom: 8px; }
        .metric-label { font-size: 14px; font-weight: 600; text-transform: uppercase; color: #9ca3af; letter-spacing: 0.05em; }
        .metric-detail { font-size: 14px; color: var(--highlight); margin-top: 12px; font-weight: 500; }

        .math-block {
            overflow-x: auto;
            padding: 30px;
            background: var(--bg-light);
            border-radius: 12px;
            margin: 40px auto;
            text-align: center;
            font-size: 1.2em;
            max-width: 900px;
        }

        .abstract {
            background: var(--bg-light);
            padding: 28px 32px;
            border-radius: 24px;
            margin: 0 auto;
            max-width: 820px;
            border-left: 6px solid var(--primary);
        }
        .abstract p {
            font-size: 16px;
            margin-bottom: 18px;
        }
        /* --- COLLAPSIBLE ABSTRACT --- */
        .abstract-toggle {
            max-width: 820px;
            margin: 0 auto 24px auto;
        }
        .abstract-toggle details {
            border-radius: 16px;
            border: 1px solid #e5e7eb;
            background: #fff;
            box-shadow: 0 8px 20px rgba(0,0,0,0.04);
            overflow: hidden;
        }
        .abstract-toggle summary {
            cursor: pointer;
            list-style: none;
            padding: 14px 18px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 16px;
            font-weight: 500;
            color: var(--primary);
            background: #f9fafb;
        }
        .abstract-toggle summary::-webkit-details-marker {
            display: none;
        }
        .abstract-toggle .summary-label {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .abstract-toggle .summary-label span {
            font-size: 13px;
            font-weight: 500;
            color: #6b7280;
        }
        .abstract-toggle .summary-icon {
            font-size: 18px;
            color: #9ca3af;
            transition: transform 0.2s ease;
        }
        .abstract-toggle details[open] .summary-icon {
            transform: rotate(90deg);
        }
        .abstract-toggle .abstract {
            border-left: none;
            border-radius: 0 0 16px 16px;
            box-shadow: none;
        }

        /* --- WHY SUPERF SECTION --- */
        .why-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 32px;
            margin: 60px 0;
        }

        .why-card {
            background: white;
            padding: 40px 32px;
            border-radius: 20px;
            border: 1px solid #e5e7eb;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .why-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px -4px rgba(0,0,0,0.1);
        }

        .why-card h3 {
            font-size: 22px;
            margin-bottom: 16px;
            color: var(--primary);
        }

        .why-card p {
            font-size: 16px;
            color: #6b7280;
            margin-bottom: 0;
            max-width: 100%;
        }

        .why-card strong {
            color: var(--highlight);
            font-weight: 600;
        }

        /* --- QUICK START SECTION --- */
        .code-block {
            background: #1f2937;
            color: #f3f4f6;
            padding: 24px;
            border-radius: 12px;
            overflow-x: auto;
            margin: 24px 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            line-height: 1.6;
        }

        .code-block code {
            color: inherit;
        }

        .param-table {
            width: 100%;
            border-collapse: collapse;
            margin: 32px 0;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .param-table th {
            background: var(--bg-light);
            padding: 16px;
            text-align: left;
            font-weight: 600;
            color: var(--primary);
            border-bottom: 2px solid #e5e7eb;
        }

        .param-table td {
            padding: 16px;
            border-bottom: 1px solid #f3f4f6;
            color: #4b5563;
        }

        .param-table tr:last-child td {
            border-bottom: none;
        }

        /* --- PROBLEM SECTION ENHANCEMENT --- */
        .problem-content {
            max-width: 900px;
            margin: 0 auto;
        }

        .problem-points {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin: 40px 0;
        }

        .problem-point {
            padding: 24px;
            background: #f9fafb;
            border-radius: 12px;
            border-left: 4px solid var(--highlight);
        }

        .problem-point strong {
            display: block;
            color: var(--primary);
            margin-bottom: 8px;
            font-size: 18px;
        }

        /* --- METHODOLOGY ENHANCEMENT --- */
        .method-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 32px;
            margin: 40px 0;
        }

        .method-step {
            padding: 32px;
            background: white;
            border-radius: 16px;
            border: 1px solid #e5e7eb;
        }

        .method-step h4 {
            font-size: 20px;
            color: var(--primary);
            margin-bottom: 12px;
            font-weight: 600;
        }

        .method-step p {
            font-size: 15px;
            color: #6b7280;
            margin-bottom: 0;
            max-width: 100%;
        }

        /* --- FOOTER --- */
        footer {
            margin-top: 120px;
            padding: 60px 0;
            border-top: 1px solid #eee;
            text-align: center;
            color: #9ca3af;
        }

        footer p {
            margin-bottom: 8px;
            max-width: 100%;
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 768px) {
            h1 { font-size: 36px; }
            h2 { font-size: 28px; }
            .hero { padding: 40px 24px; }
            .hero .alignment-container {
                height: 280px;
                max-width: 100%;
            }
            .abstract { padding: 24px; }
            .stack-container { transform: scale(0.8); }
            .alignment-container {
                width: 100%;
                max-width: 300px;
                height: 225px;
            }
            .why-grid, .method-steps, .problem-points {
                grid-template-columns: 1fr;
            }
            .examples-container {
                grid-template-columns: 1fr;
                gap: 40px;
            }
            .timelapse-container {
                margin: 40px auto;
                border-radius: 12px;
            }
            .param-table {
                font-size: 12px;
            }
            .param-table th,
            .param-table td {
                padding: 12px 8px;
            }
        }

        /* --- BURST INPUT SEQUENCE CARD --- */
        .burst-sequence {
            max-width: 1100px;
            margin: 60px auto 10px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 32px;
            align-items: start;
            position: relative;
        }
        
        .burst-sequence-wrapper {
            position: relative;
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 80px;
        }
        
        .burst-sequence-wrapper {
            overflow: hidden;
        }
        
        .burst-sequence-container {
            display: flex;
            gap: 32px;
            width: max-content;
            transition: transform 0.4s ease-in-out;
        }
        
        .burst-sequence-container .sequence-card {
            flex: 0 0 calc(33.333% - 22px);
            min-width: 0;
            max-width: calc(33.333% - 22px);
        }
        
        @media (max-width: 900px) {
            .burst-sequence-container .sequence-card {
                flex: 0 0 calc(50% - 16px);
                max-width: calc(50% - 16px);
            }
        }
        
        @media (max-width: 600px) {
            .burst-sequence-container .sequence-card {
                flex: 0 0 100%;
                max-width: 100%;
            }
        }
        
        .sequence-nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: white;
            border: 2px solid var(--primary);
            color: var(--primary);
            width: 48px;
            height: 48px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            z-index: 10;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: all 0.2s;
        }
        
        .sequence-nav-btn:hover {
            background: var(--primary);
            color: white;
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        
        .sequence-nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .sequence-nav-btn.prev {
            left: 10px;
        }
        
        .sequence-nav-btn.next {
            right: 10px;
        }
        
        @media (max-width: 1200px) {
            .sequence-nav-btn.prev {
                left: 10px;
            }
            .sequence-nav-btn.next {
                right: 10px;
            }
        }
        .sequence-card {
            background: #fff;
            border-radius: 20px;
            border: 1px solid #e5e7eb;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        .sequence-display {
            position: relative;
            width: 100%;
            padding-top: 100%;
            border-radius: 16px;
            overflow: hidden;
            background-color: #000;
            cursor: pointer;
            transition: box-shadow 0.3s ease, transform 0.3s ease;
            box-shadow: inset 0 0 30px rgba(0,0,0,0.25);
        }
        .sequence-display:hover,
        .sequence-display:focus-visible {
            box-shadow: inset 0 0 25px rgba(0,0,0,0.35);
        }
        .sequence-display:focus-visible {
            outline: 3px solid rgba(59,130,246,0.6);
            outline-offset: 6px;
        }
        .sequence-display.is-pressed {
            box-shadow: 0 15px 35px rgba(59,130,246,0.35);
            transform: translateY(-2px) scale(1.01);
        }
        .sequence-display img {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            image-rendering: pixelated;
            pointer-events: none;
            -webkit-user-drag: none;
            user-select: none;
        }
        .sequence-label {
            position: absolute;
            bottom: 12px;
            right: 12px;
            background: rgba(0,0,0,0.65);
            color: white;
            font-size: 12px;
            letter-spacing: 0.06em;
            padding: 4px 10px;
            border-radius: 999px;
            text-transform: uppercase;
            pointer-events: none;
        }
        .sequence-instructions {
            font-size: 16px;
            color: #4b5563;
            margin-top: 18px;
            line-height: 1.6;
        }
        .sequence-details {
            font-size: 14px;
            color: #9ca3af;
            margin-top: 8px;
        }
    </style>
</head>
<body>

    <div class="container">
        
        <header class="hero">
            <div class="hero-inner">
                <div class="hero-text">
                    <h1>SuperF</h1>
                    <p class="tagline">Neural Implicit Fields for Multi-Image Super-Resolution</p>
                    <p class="authors">
                        Sander Riisøen Jyhne<sup>1,*</sup>, <a href="https://christian-igel.github.io/" target="_blank" rel="noopener noreferrer">Christian Igel</a><sup>2</sup>, <a href="https://mortengoodwin.no/" target="_blank" rel="noopener noreferrer">Morten Goodwin</a><sup>1</sup>, Per-Arne Andersen<sup>1</sup>, <a href="https://sergebelongie.github.io/" target="_blank" rel="noopener noreferrer">Serge Belongie</a><sup>2</sup>, <a href="https://langnico.github.io/" target="_blank" rel="noopener noreferrer">Nico Lang</a><sup>2,*</sup>
                    </p>
                    <p class="affiliations">
                        <sup>1</sup>University of Agder &nbsp;&middot;&nbsp; <sup>2</sup>University of Copenhagen<br>
                        <span style="font-size: 13px; color: #9ca3af;">*Corresponding authors: <a href="mailto:sander.jyhne@kartverket.no" style="color: #6b7280; text-decoration: none; border-bottom: 1px solid rgba(59, 130, 246, 0.3);">sander.jyhne@kartverket.no</a>, <a href="mailto:nila@di.ku.dk" style="color: #6b7280; text-decoration: none; border-bottom: 1px solid rgba(59, 130, 246, 0.3);">nila@di.ku.dk</a></span>
                    </p>
                    <div class="links">
                        <a class="btn disabled">Code</a>
                        <a class="btn disabled">Dataset</a>
                        <a href="SuperF.pdf" class="btn secondary">Paper</a>
                        <a href="https://huggingface.co/spaces/sjyhne/superf_demo" class="btn secondary" target="_blank" rel="noopener noreferrer">Demo</a>
                    </div>
                    <p style="font-size: 13px; color: #9ca3af; margin-top: 12px; margin-bottom: 0;">
                        *Code and datasets are coming soon.
                    </p>
                </div>
            </div>
        </header>

        <section id="abstract">
            <h2>Abstract</h2>
            <div class="abstract-toggle">
                <details open>
                    <summary>
                        <div class="summary-label">
                            <span id="abstract-toggle-text" style="font-weight:600; color:var(--primary);">Hide abstract</span>
                        </div>
                        <span class="summary-icon">&#8250;</span>
                    </summary>
                    <div class="abstract">
                        <p>
                            High-resolution imagery is often hindered by limitations in sensor technology, atmospheric conditions, and costs. Such challenges occur in satellite remote sensing, but also with handheld cameras, such as our smartphones. Hence, super-resolution aims to enhance image resolution algorithmically. Since single-image super-resolution requires solving an inverse problem, such methods must exploit strong priors, e.g. learned from high-resolution training data, or be constrained by auxiliary data, e.g. by a high-resolution guide from another modality. While qualitatively pleasing, such approaches often lead to hallucinated structures that do not match reality.
                        </p>
                        <p>
                            In contrast, multi-image super-resolution (MISR) aims to improve resolution by constraining the reconstruction with multiple views taken with sub-pixel shifts. We propose SuperF, a test-time optimization approach for MISR that leverages coordinate-based neural networks, also called neural fields. Their ability to represent continuous signals with an implicit neural representation (INR) makes them an ideal fit for the MISR task. The key characteristic of our approach is to share an INR for multiple shifted low-resolution frames and to jointly optimize the frame alignment with the INR. Our approach advances related INR baselines by directly parameterizing the sub-pixel alignment as optimizable affine transformation parameters and by optimizing via a super-sampled coordinate grid that corresponds to the output resolution. Our experiments yield compelling results on simulated bursts of satellite imagery and ground-level images from handheld cameras, with upsampling factors of up to 8. A key advantage of SuperF is that this approach does not rely on any high-resolution training data.
                        </p>
                    </div>
                </details>
            </div>
        </section>

        <section id="misr">
            <div style="text-align: center; margin: 32px 0;">
                <video src="figs/SuperF-problem-animation-v2-1080p.mp4" controls playsinline style="max-width: 100%; border-radius: 16px; box-shadow: 0 12px 32px rgba(0,0,0,0.25);">
                    Your browser does not support the video tag.
                </video>
                <p style="font-size: 14px; color: #6b7280; margin-top: 8px; max-width: 700px; margin-left: auto; margin-right: auto;">
                    Animation of the MISR setup: multiple jittered low-resolution frames combining into a sharp reconstruction.
                </p>
            </div>
        </section>

        <section id="method">
            <h2>Methodology</h2>
            <p>
                We introduce SuperF, a test-time optimization approach that leverages Implicit Neural Representations (INRs) to achieve super-resolution without the need for high-resolution training data. SuperF shares a single INR across multiple low-resolution frames, jointly optimizing the neural network alongside the sub-pixel alignment of each frame. By parameterizing these alignments as affine transformations and optimizing on a super-sampled coordinate grid, our method effectively reconstructs the underlying high-resolution signal. Furthermore, SuperF can estimate uncertainty maps to robustly handle noise, such as ignoring pixels obscured by clouds in satellite imagery.
            </p>
            <div style="text-align: center; margin: 32px 0;">
                <div style="display: inline-flex; gap: 12px; margin-bottom: 24px;">
                    <button id="method-toggle-figure" class="method-toggle-btn active" onclick="switchMethodView('figure')" style="padding: 10px 24px; border: 2px solid var(--primary); background: var(--primary); color: white; border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: 600; transition: all 0.2s;">
                        Figure
                    </button>
                    <button id="method-toggle-video" class="method-toggle-btn" onclick="switchMethodView('video')" style="padding: 10px 24px; border: 2px solid #e5e7eb; background: white; color: var(--primary); border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: 600; transition: all 0.2s;">
                        Animation
                    </button>
                </div>
                <div id="method-figure-container" style="display: block;">
                    <div style="display: inline-block; background: #fff; padding: 10px; border-radius: 16px; box-shadow: 0 16px 40px rgba(0,0,0,0.25);">
                        <img src="figs/SuperF_method_v2.png" alt="Overview of the SuperF method (v2)" style="width: 100%; max-width: 1200px; border-radius: 12px; display: block;">
                    </div>
                    <p style="font-size: 14px; color: #6b7280; margin-top: 8px; max-width: 700px; margin-left: auto; margin-right: auto;">
                        Figure 1: Overview of the SuperF method, showing the shared implicit neural representation, frame-specific alignments, and super-resolved reconstruction.
                    </p>
                </div>
                <div id="method-video-container" style="display: none;">
                    <video src="figs/SuperF_method_animation-1080p.mp4" controls playsinline style="max-width: 100%; border-radius: 16px; box-shadow: 0 12px 32px rgba(0,0,0,0.25);">
                        Your browser does not support the video tag.
                    </video>
                    <p style="font-size: 14px; color: #6b7280; margin-top: 8px; max-width: 700px; margin-left: auto; margin-right: auto;">
                        Animation of the SuperF method, illustrating joint alignment, the shared neural field, and super-resolved output.
                    </p>
                </div>
            </div>
        </section>

        <section id="uncertainty">
            <h2>Robustness: Handling Real-World Noise</h2>
            <p style="max-width: 800px; margin: 0 auto;">
                Real-world imagery is rarely perfect. Satellite observations are frequently obstructed by clouds or shadows, while handheld bursts often contain moving objects or lighting shifts. Standard super-resolution methods can be easily confused by these inconsistencies, resulting in glitchy artifacts in the final image. <strong>SuperF does not just reconstruct the image; it also learns to estimate its own confidence</strong> via <strong>pixel-wise uncertainty maps</strong> that identify which parts of an image are reliable and which are noisy. During optimization, the model assigns <strong>high uncertainty to outliers</strong>—such as a cloud that appears in only one satellite frame—and effectively ignores or strongly down-weights these corrupted pixels. This allows SuperF to extract the <strong>consistent, high-quality underlying structure</strong> of the scene, even when individual input frames are messy or partially occluded.
            </p>
            <div style="max-width: 1100px; margin: 32px auto 12px auto; position: relative;">
                <div id="uncertainty-carousel" style="position: relative; overflow: hidden; border-radius: 12px;">
                    <div id="uncertainty-images" style="display: flex; transition: transform 0.4s ease-in-out;">
                        <img src="figs/uncertainty_map_1.png" alt="Uncertainty example 1" class="uncertainty-slide" style="min-width: 100%; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.15);">
                        <img src="figs/uncertainty_map_2.png" alt="Uncertainty example 2" class="uncertainty-slide" style="min-width: 100%; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.15);">
                        <img src="figs/uncertainty_map_3.png" alt="Uncertainty example 3" class="uncertainty-slide" style="min-width: 100%; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.15);">
                        <img src="figs/uncertainty_map_4.png" alt="Uncertainty example 4" class="uncertainty-slide" style="min-width: 100%; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.15);">
                    </div>
                    <button id="uncertainty-prev" onclick="changeUncertaintySlide(-1)" style="position: absolute; left: 16px; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.9); border: 2px solid var(--primary); color: var(--primary); width: 44px; height: 44px; border-radius: 50%; cursor: pointer; font-size: 20px; font-weight: bold; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(0,0,0,0.15); transition: all 0.2s; z-index: 10;">‹</button>
                    <button id="uncertainty-next" onclick="changeUncertaintySlide(1)" style="position: absolute; right: 16px; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.9); border: 2px solid var(--primary); color: var(--primary); width: 44px; height: 44px; border-radius: 50%; cursor: pointer; font-size: 20px; font-weight: bold; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(0,0,0,0.15); transition: all 0.2s; z-index: 10;">›</button>
                </div>
                <div style="display: flex; justify-content: center; gap: 8px; margin-top: 16px;">
                    <span class="uncertainty-dot active" onclick="goToUncertaintySlide(0)" style="width: 12px; height: 12px; border-radius: 50%; background: var(--primary); cursor: pointer; transition: all 0.2s;"></span>
                    <span class="uncertainty-dot" onclick="goToUncertaintySlide(1)" style="width: 12px; height: 12px; border-radius: 50%; background: #d1d5db; cursor: pointer; transition: all 0.2s;"></span>
                    <span class="uncertainty-dot" onclick="goToUncertaintySlide(2)" style="width: 12px; height: 12px; border-radius: 50%; background: #d1d5db; cursor: pointer; transition: all 0.2s;"></span>
                    <span class="uncertainty-dot" onclick="goToUncertaintySlide(3)" style="width: 12px; height: 12px; border-radius: 50%; background: #d1d5db; cursor: pointer; transition: all 0.2s;"></span>
                </div>
            </div>
            <p style="max-width: 800px; margin: 0 auto; font-size: 14px; color: #6b7280; text-align: center;">
                Four examples showing LR frames (top row) and the corresponding estimated uncertainty maps (bottom row) for images with occlusions and inconsistencies. The uncertainty maps highlight cloudy or inconsistent pixels, enabling the GNLL loss to downweight these during optimization.
            </p>
        </section>

        <section id="results">
            <h2>Results</h2>
            <p style="max-width: 800px; margin: 0 auto 32px auto;">
                SuperF consistently outperforms test-time optimization baselines across multiple datasets, delivering sharper detail and lower perceptual error.
            </p>
            <h3 style="text-align: center; font-size: 24px; font-weight: 600; color: var(--primary); margin: 40px 0 20px 0;">
                Quantitative Results
            </h3>
            <div style="text-align: center; margin: 40px 0;">
                <div style="display: inline-block; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.1); overflow-x: auto; max-width: 100%;">
                    <table style="border-collapse: collapse; font-size: 14px; min-width: 800px; margin: 0 auto;">
                        <caption style="font-weight: 600; margin-bottom: 12px; text-align: left; font-size: 15px;">
                            <strong>Comparison with TTO baselines.</strong> PSNR (↑) for different upscaling factors. Note that the SatSynthBurst fixes the HR output resolution while SyntheticBurst fixes the resolution of the LR frames. Hence, as the upsampling factor increases, we only expect lower performance metrics for SatSynthBurst.<br>
                            <em>Experimental setup:</em> upsampling factors ×2, ×4, ×8, 16 LR frames. Standard deviation across samples is given in parentheses and the number of iterations in square brackets.
                        </caption>
                        <thead>
                            <tr>
                                <th style="border-bottom: 2px solid #333; padding: 10px 12px; text-align: left; font-weight: 600;"></th>
                                <th colspan="3" style="border-bottom: 2px solid #333; padding: 10px 12px; text-align: center; font-weight: 600;">SatSynthBurst</th>
                                <th colspan="3" style="border-bottom: 2px solid #333; padding: 10px 12px; text-align: center; font-weight: 600;">SyntheticBurst</th>
                            </tr>
                            <tr>
                                <th style="border-bottom: 1px solid #ddd; padding: 8px 12px; text-align: left; font-weight: 500;"></th>
                                <th style="border-bottom: 1px solid #ddd; padding: 8px 12px; text-align: center; font-weight: 500;">×2</th>
                                <th style="border-bottom: 1px solid #ddd; padding: 8px 12px; text-align: center; font-weight: 500;">×4</th>
                                <th style="border-bottom: 1px solid #ddd; padding: 8px 12px; text-align: center; font-weight: 500;">×8</th>
                                <th style="border-bottom: 1px solid #ddd; padding: 8px 12px; text-align: center; font-weight: 500;">×2</th>
                                <th style="border-bottom: 1px solid #ddd; padding: 8px 12px; text-align: center; font-weight: 500;">×4</th>
                                <th style="border-bottom: 1px solid #ddd; padding: 8px 12px; text-align: center; font-weight: 500;">×8</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: left;">Bilinear</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">34.69 (3.50)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">29.71 (3.64)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">26.62 (3.68)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">27.66 (3.50)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">26.12 (3.72)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">25.44 (3.82)</td>
                            </tr>
                            <tr>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: left;">Lafenetre et al. (2023)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">33.46 (3.62)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">27.70 (3.79)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">24.88 (3.71)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">27.02 (3.29)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">26.46 (3.05)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">25.19 (2.97)</td>
                            </tr>
                            <tr>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: left;">NIR (Nam et al., 2022) [2k]</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">26.26 (3.91)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">24.63 (4.41)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">23.85 (3.79)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">23.62 (4.43)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">22.69 (4.41)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">22.28 (4.40)</td>
                            </tr>
                            <tr>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: left;">NIR (Nam et al., 2022) [5k]</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">25.65 (5.82)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">24.99 (4.12)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">23.61 (2.97)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">24.46 (4.31)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">23.39 (4.32)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">22.93 (4.33)</td>
                            </tr>
                            <tr>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: left;">SuperF MSE (ours) [2k]</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">36.73 (1.66)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">32.94 (1.83)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">28.87 (2.32)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center;">29.38 (3.43)</td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center; font-weight: 700;"><strong>27.90 (3.94)</strong></td>
                                <td style="border-bottom: 1px solid #eee; padding: 10px 12px; text-align: center; font-weight: 700;"><strong>27.08 (3.97)</strong></td>
                            </tr>
                            <tr>
                                <td style="border-bottom: 2px solid #333; padding: 10px 12px; text-align: left; font-weight: 600;">SuperF GNLL (ours) [2k]</td>
                                <td style="border-bottom: 2px solid #333; padding: 10px 12px; text-align: center; font-weight: 700;"><strong>37.26 (2.30)</strong></td>
                                <td style="border-bottom: 2px solid #333; padding: 10px 12px; text-align: center; font-weight: 700;"><strong>34.03 (2.71)</strong></td>
                                <td style="border-bottom: 2px solid #333; padding: 10px 12px; text-align: center; font-weight: 700;"><strong>29.28 (3.21)</strong></td>
                                <td style="border-bottom: 2px solid #333; padding: 10px 12px; text-align: center; font-weight: 700;"><strong>29.48 (3.76)</strong></td>
                                <td style="border-bottom: 2px solid #333; padding: 10px 12px; text-align: center; font-weight: 400;">27.47 (4.18)</td>
                                <td style="border-bottom: 2px solid #333; padding: 10px 12px; text-align: center; font-weight: 400;">26.58 (4.18)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <h3 style="text-align: center; font-size: 24px; font-weight: 600; color: var(--primary); margin: 60px 0 20px 0;">
                Real Satellite Data
            </h3>
            <p style="text-align: center; max-width: 800px; margin: 0 auto 24px auto; font-size: 16px; color: #6b7280;">
                Results on <strong>real satellite imagery</strong> from Sentinel-2 time series. These reconstructions were generated using the SuperF demo application.
            </p>
            <div style="text-align: center; margin: 0 auto 20px auto;">
                <div style="display: inline-flex; gap: 12px; margin-bottom: 20px;">
                    <button id="sequence-toggle-interactive" class="sequence-view-toggle active" onclick="switchSequenceView('interactive')" style="padding: 10px 24px; border: 2px solid var(--primary); background: var(--primary); color: white; border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: 600; transition: all 0.2s; min-width: 140px;">
                        Interactive
                    </button>
                    <button id="sequence-toggle-slider" class="sequence-view-toggle" onclick="switchSequenceView('slider')" style="padding: 10px 24px; border: 2px solid #e5e7eb; background: white; color: var(--primary); border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: 600; transition: all 0.2s; min-width: 140px;">
                        Slider
                    </button>
                </div>
                <p id="sequence-instructions" class="sequence-instructions" style="text-align:center; max-width: 780px; margin: 0 auto;">
                    Each tile loops through the LR burst automatically. <strong>Hover</strong> (or focus) to freeze on our base LR frame, then <strong>press / long-press</strong> to show the SuperF SR output. Let go to resume the LR sequence.
                </p>
            </div>
            <div id="burst-sequence-interactive" class="burst-sequence-wrapper" style="margin-top: 0; display: block;">
                <button class="sequence-nav-btn prev" onclick="navigateSequence('interactive', -1)" aria-label="Previous sequences">‹</button>
                <div class="burst-sequence-container">
                    <div class="sequence-card">
                        <div class="sequence-display" data-sequence="cph" role="button" tabindex="0" aria-pressed="false" aria-label="CPH burst: hover for base LR frame, press to show SR output">
                            <img class="sequence-img" src="figs/cph/2025-04-03_S2B_33UUB_20250403_0_L2A.png" alt="Animated Copenhagen LR burst frames" draggable="false" loading="lazy">
                            <span class="sequence-label">LR Sequence</span>
                        </div>
                    </div>
                    <div class="sequence-card">
                        <div class="sequence-display" data-sequence="circle" role="button" tabindex="0" aria-pressed="false" aria-label="Circle burst: hover for base LR frame, press to show SR output">
                            <img class="sequence-img" src="figs/circle/2025-04-02_S2A_30STG_20250402_1_L2A.png" alt="Animated circle LR burst frames" draggable="false" loading="lazy">
                            <span class="sequence-label">LR Sequence</span>
                        </div>
                    </div>
                    <div class="sequence-card">
                        <div class="sequence-display" data-sequence="roundabout" role="button" tabindex="0" aria-pressed="false" aria-label="Roundabout burst: hover for base LR frame, press to show SR output">
                            <img class="sequence-img" src="figs/roundabout/2025-04-17_S2C_17RMP_20250417_0_L2A.png" alt="Animated roundabout LR burst frames" draggable="false" loading="lazy">
                            <span class="sequence-label">LR Sequence</span>
                        </div>
                    </div>
                    <div class="sequence-card">
                        <div class="sequence-display" data-sequence="island" role="button" tabindex="0" aria-pressed="false" aria-label="Island burst: hover for base LR frame, press to show SR output">
                            <img class="sequence-img" src="figs/island/2025-02-06_S2B_48PUV_20250206_0_L2A.png" alt="Animated island LR burst frames" draggable="false" loading="lazy">
                            <span class="sequence-label">LR Sequence</span>
                        </div>
                    </div>
                    <div class="sequence-card">
                        <div class="sequence-display" data-sequence="kjevik" role="button" tabindex="0" aria-pressed="false" aria-label="Kjevik burst: hover for base LR frame, press to show SR output">
                            <img class="sequence-img" src="figs/kjevik/2025-04-01_S2C_32VMK_20250401_0_L2A.png" alt="Animated Kjevik LR burst frames" draggable="false" loading="lazy">
                            <span class="sequence-label">LR Sequence</span>
                        </div>
                    </div>
                </div>
                <button class="sequence-nav-btn next" onclick="navigateSequence('interactive', 1)" aria-label="Next sequences">›</button>
            </div>
            <div id="burst-sequence-slider" class="burst-sequence-wrapper" style="margin-top: 0; display: none;">
                <button class="sequence-nav-btn prev" onclick="navigateSequence('slider', -1)" aria-label="Previous sequences">‹</button>
                <div class="burst-sequence-container">
                <div class="sequence-card">
                    <div class="slider-container" style="position: relative; width: 100%; border-radius: 16px; overflow: hidden; box-shadow: 0 8px 24px rgba(0,0,0,0.15);">
                        <img class="slider-lr" src="figs/cph/2025-05-08_S2C_33UUB_20250508_0_L2A.png" alt="Copenhagen LR">
                        <img class="slider-sr" src="figs/cph/sr_sample_000.png" alt="Copenhagen SR" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; clip-path: inset(0 50% 0 0);">
                        <input type="range" class="slider-control" min="0" max="100" value="50" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; margin: 0; opacity: 0; cursor: ew-resize; z-index: 10;" oninput="updateSlider(this, 'cph')">
                        <div class="slider-divider" style="position: absolute; top: 0; left: 50%; width: 2px; height: 100%; background: white; box-shadow: 0 0 4px rgba(0,0,0,0.3); pointer-events: none; z-index: 5; transform: translateX(-50%);"></div>
                    </div>
                </div>
                <div class="sequence-card">
                    <div class="slider-container" style="position: relative; width: 100%; border-radius: 16px; overflow: hidden; box-shadow: 0 8px 24px rgba(0,0,0,0.15);">
                        <img class="slider-lr" src="figs/circle/2025-05-10_S2C_30STG_20250510_0_L2A.png" alt="Circle LR">
                        <img class="slider-sr" src="figs/circle/sr_sample_000.png" alt="Circle SR" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; clip-path: inset(0 50% 0 0);">
                        <input type="range" class="slider-control" min="0" max="100" value="50" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; margin: 0; opacity: 0; cursor: ew-resize; z-index: 10;" oninput="updateSlider(this, 'circle')">
                        <div class="slider-divider" style="position: absolute; top: 0; left: 50%; width: 2px; height: 100%; background: white; box-shadow: 0 0 4px rgba(0,0,0,0.3); pointer-events: none; z-index: 5; transform: translateX(-50%);"></div>
                    </div>
                </div>
                <div class="sequence-card">
                    <div class="slider-container" style="position: relative; width: 100%; border-radius: 16px; overflow: hidden; box-shadow: 0 8px 24px rgba(0,0,0,0.15);">
                        <img class="slider-lr" src="figs/roundabout/2025-05-17_S2C_17RMP_20250517_0_L2A.png" alt="Roundabout LR">
                        <img class="slider-sr" src="figs/roundabout/sr_sample_000.png" alt="Roundabout SR" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; clip-path: inset(0 50% 0 0);">
                        <input type="range" class="slider-control" min="0" max="100" value="50" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; margin: 0; opacity: 0; cursor: ew-resize; z-index: 10;" oninput="updateSlider(this, 'roundabout')">
                        <div class="slider-divider" style="position: absolute; top: 0; left: 50%; width: 2px; height: 100%; background: white; box-shadow: 0 0 4px rgba(0,0,0,0.3); pointer-events: none; z-index: 5; transform: translateX(-50%);"></div>
                    </div>
                </div>
                <div class="sequence-card">
                    <div class="slider-container" style="position: relative; width: 100%; border-radius: 16px; overflow: hidden; box-shadow: 0 8px 24px rgba(0,0,0,0.15);">
                        <img class="slider-lr" src="figs/island/2025-04-12_S2C_48PUV_20250412_0_L2A.png" alt="Island LR">
                        <img class="slider-sr" src="figs/island/sr_sample_000.png" alt="Island SR" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; clip-path: inset(0 50% 0 0);">
                        <input type="range" class="slider-control" min="0" max="100" value="50" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; margin: 0; opacity: 0; cursor: ew-resize; z-index: 10;" oninput="updateSlider(this, 'island')">
                        <div class="slider-divider" style="position: absolute; top: 0; left: 50%; width: 2px; height: 100%; background: white; box-shadow: 0 0 4px rgba(0,0,0,0.3); pointer-events: none; z-index: 5; transform: translateX(-50%);"></div>
                    </div>
                </div>
                <div class="sequence-card">
                    <div class="slider-container" style="position: relative; width: 100%; border-radius: 16px; overflow: hidden; box-shadow: 0 8px 24px rgba(0,0,0,0.15);">
                        <img class="slider-lr" src="figs/kjevik/2025-05-06_S2A_32VMK_20250506_1_L2A.png" alt="Kjevik LR">
                        <img class="slider-sr" src="figs/kjevik/sr_sample_000.png" alt="Kjevik SR" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; clip-path: inset(0 50% 0 0);">
                        <input type="range" class="slider-control" min="0" max="100" value="50" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; margin: 0; opacity: 0; cursor: ew-resize; z-index: 10;" oninput="updateSlider(this, 'kjevik')">
                        <div class="slider-divider" style="position: absolute; top: 0; left: 50%; width: 2px; height: 100%; background: white; box-shadow: 0 0 4px rgba(0,0,0,0.3); pointer-events: none; z-index: 5; transform: translateX(-50%);"></div>
                    </div>
                </div>
                </div>
                <button class="sequence-nav-btn next" onclick="navigateSequence('slider', 1)" aria-label="Next sequences">›</button>
            </div>
            <h3 style="text-align: center; font-size: 24px; font-weight: 600; color: var(--primary); margin: 60px 0 20px 0;">
                Qualitative Comparison
            </h3>
            <p style="text-align: center; max-width: 800px; margin: 0 auto 24px auto; font-size: 16px; color: #6b7280;">
                Results on <strong>synthetic data</strong> for both satellite images and ground-level bursts.
            </p>
            <div style="max-width: 1100px; margin: 20px auto 12px auto; position: relative;">
                <div id="qualitative-carousel" style="position: relative; overflow: hidden; border-radius: 12px;">
                    <div id="qualitative-images" style="display: flex; transition: transform 0.4s ease-in-out;">
                        <img src="figs/qualitative_examples_many_df2 (1)-1.png" alt="Qualitative examples df2" class="qualitative-slide" style="min-width: 100%; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.15);">
                        <img src="figs/qualitative_examples_many_df4 (1)-1.png" alt="Qualitative examples df4" class="qualitative-slide" style="min-width: 100%; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.15);">
                        <img src="figs/qualitative_examples_many_df8 (1)-1.png" alt="Qualitative examples df8" class="qualitative-slide" style="min-width: 100%; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.15);">
                    </div>
                    <button id="qualitative-prev" onclick="changeQualitativeSlide(-1)" style="position: absolute; left: 16px; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.9); border: 2px solid var(--primary); color: var(--primary); width: 44px; height: 44px; border-radius: 50%; cursor: pointer; font-size: 20px; font-weight: bold; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(0,0,0,0.15); transition: all 0.2s; z-index: 10;">‹</button>
                    <button id="qualitative-next" onclick="changeQualitativeSlide(1)" style="position: absolute; right: 16px; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.9); border: 2px solid var(--primary); color: var(--primary); width: 44px; height: 44px; border-radius: 50%; cursor: pointer; font-size: 20px; font-weight: bold; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(0,0,0,0.15); transition: all 0.2s; z-index: 10;">›</button>
                </div>
                <div style="display: flex; justify-content: center; gap: 8px; margin-top: 16px;">
                    <span class="qualitative-dot active" onclick="goToQualitativeSlide(0)" style="width: 12px; height: 12px; border-radius: 50%; background: var(--primary); cursor: pointer; transition: all 0.2s;"></span>
                    <span class="qualitative-dot" onclick="goToQualitativeSlide(1)" style="width: 12px; height: 12px; border-radius: 50%; background: #d1d5db; cursor: pointer; transition: all 0.2s;"></span>
                    <span class="qualitative-dot" onclick="goToQualitativeSlide(2)" style="width: 12px; height: 12px; border-radius: 50%; background: #d1d5db; cursor: pointer; transition: all 0.2s;"></span>
                </div>
                <p id="qualitative-caption" style="font-size: 16px; font-weight: 600; color: var(--primary); margin-top: 16px; text-align: center;">
                    Upsampling Factor: ×2
                </p>
                <p style="font-size: 14px; color: #6b7280; margin-top: 8px; text-align: center; max-width: 800px; margin-left: auto; margin-right: auto;">
                    Qualitative comparison of SuperF reconstructions against baseline methods.
                </p>
            </div>
        </section>

        <section id="demo">
            <h2>Demo App</h2>
            <p style="max-width: 800px; margin: 0 auto 24px auto;">
                Try SuperF in your browser: choose a location and time period, and inspect the super-resolved render directly.
            </p>
            <div style="text-align: center; margin: 32px 0;">
                <a href="https://huggingface.co/spaces/sjyhne/superf_demo" class="btn" target="_blank" rel="noopener noreferrer" style="display: inline-block;">
                    Try SuperF Demo
                </a>
            </div>
        </section>

        <section>
            <h2>Citation</h2>
            <pre style="background: #1f2937; color: #f3f4f6; padding: 24px; border-radius: 12px; overflow-x: auto;"><code>@misc{jyhne2025superfneuralimplicitfields,
                title={SuperF: Neural Implicit Fields for Multi-Image Super-Resolution}, 
                author={Sander Riisøen Jyhne and Christian Igel and Morten Goodwin and Per-Arne Andersen and Serge Belongie and Nico Lang},
                year={2025},
                eprint={2512.09115},
                archivePrefix={arXiv},
                primaryClass={cs.CV},
                url={https://arxiv.org/abs/2512.09115}, 
          }</code></pre>
        </section>

        <footer>
            <p>&copy; 2026 SuperF Project</p>
            <p style="font-size: 14px; margin-top: 10px;">Website template inspired by Nerfies</p>
        </footer>

    </div>

    <script type="module" src="https://gradio.s3-us-west-2.amazonaws.com/4.12.0/gradio.js"></script>
    <script>
        // --- GENERIC MAGIC LENS LOGIC ---
        // This function enables the lens effect on any container with the right structure
        function initLens(containerId, lensId) {
            const container = document.getElementById(containerId);
            const lens = document.getElementById(lensId);
            
            if(!container || !lens) return;

            function moveLens(e) {
                const rect = container.getBoundingClientRect();
                let x = e.clientX - rect.left;
                let y = e.clientY - rect.top;

                // Clamp bounds
                if (x < 0) x = 0; if (x > rect.width) x = rect.width;
                if (y < 0) y = 0; if (y > rect.height) y = rect.height;

                // Move lens (half of 280px = 140px)
                const halfSize = 140; 
                lens.style.left = (x - halfSize) + 'px';
                lens.style.top = (y - halfSize) + 'px';

                // Position background Absolute to Container (No parallax)
                const bgLeft = -1 * x + halfSize; 
                const bgTop = -1 * y + halfSize;
                
                lens.style.backgroundPosition = `${bgLeft}px ${bgTop}px`;
                lens.style.backgroundSize = `${rect.width}px ${rect.height}px`;
            }

            container.addEventListener('mousemove', moveLens);
            container.addEventListener('mouseenter', () => { 
                lens.style.display = 'block'; 
                const rect = container.getBoundingClientRect();
                lens.style.backgroundSize = `${rect.width}px ${rect.height}px`;
            });
            container.addEventListener('mouseleave', () => { lens.style.display = 'none'; });
            container.addEventListener('touchmove', (e) => { e.preventDefault(); moveLens(e.touches[0]); }, { passive: false });
        }

        // --- TIMELAPSE ANIMATION ---
        function initTimelapse() {
            const timelapseImg = document.getElementById('timelapse-img');
            const timelapseSlider = document.getElementById('timelapse-slider');
            const timelapseFrameInfo = document.getElementById('timelapse-frame-info');
            const timelapseOptions = document.querySelectorAll('.timelapse-option');
            if (!timelapseImg || !timelapseSlider) return;

            // Define both timelapses
            const timelapses = {
                kjevik: {
                    folder: 'timelapse',
                    frames: [
                        '000001', '000024', '000047', '000070', '000093', '000116', '000139', '000162',
                        '000185', '000208', '000231', '000254', '000277', '000300', '000323', '000346',
                        '000369', '000392', '000415', '000438', '000461', '000484', '000507', '000530',
                        '000553', '000576', '000599', '000622', '000645', '000668', '000691', '000714',
                        '000737', '000760', '000783', '000806', '000829', '000852', '000875', '000898',
                        '000921', '000944', '000967', '000990', '001013', '001036', '001059', '001082',
                        '001105', '001128', '001151', '001174', '001197', '001220', '001243', '001266',
                        '001289', '001312', '001335', '001358', '001381', '001404', '001427', '001450',
                        '001473', '001496', '001519', '001542', '001565', '001588', '001611', '001634',
                        '001657', '001680', '001703', '001726', '001749', '001772', '001795', '001818',
                        '001841', '001864', '001887', '001910', '001933', '001956', '001979'
                    ]
                },
                island: {
                    folder: 'timelapse_island',
                    frames: [
                        '000001', '000010', '000019', '000028', '000037', '000046', '000055', '000064',
                        '000073', '000082', '000091', '000100', '000109', '000118', '000127', '000136',
                        '000145', '000154', '000163', '000172', '000181', '000190',
                        '000199', '000208', '000217', '000226', '000235', '000244', '000253',
                        '000262', '000271', '000280', '000289', '000298', '000307', '000316', '000325',
                        '000334', '000343', '000352', '000361', '000370', '000379', '000388',
                        '000397', '000406', '000415', '000424', '000433', '000442', '000451', '000460',
                        '000469', '000478', '000487', '000496', '000505', '000514', '000523', '000532',
                        '000541', '000550', '000559', '000568', '000577', '000586', '000595',
                        '000604', '000613', '000622', '000631', '000640', '000649', '000658',
                        '000667', '000676', '000685', '000694', '000703', '000712', '000721', '000730',
                        '000739', '000748', '000757', '000766', '000775', '000784', '000793', '000802',
                        '000811', '000820', '000829', '000838', '000847', '000856', '000865', '000874',
                        '000883', '000892', '000901', '000910', '000919', '000928', '000937', '000946',
                        '000955', '000964', '000973', '000982', '000991', '001000', '001009', '001018',
                        '001027', '001036', '001045', '001054', '001063', '001072', '001081', '001090',
                        '001099', '001108', '001117', '001126', '001135', '001144', '001153',
                        '001162', '001171', '001180', '001189', '001198', '001207', '001216', '001225', '001234',
                        '001243', '001252', '001261', '001270', '001279', '001288', '001297', '001306',
                        '001315', '001324', '001333', '001342', '001351', '001360', '001369', '001378',
                        '001387', '001396', '001405', '001414', '001423', '001432', '001441', '001450',
                        '001459', '001468', '001477', '001486', '001495', '001504', '001513', '001522',
                        '001531', '001540', '001549', '001558', '001567', '001576', '001585', '001594',
                        '001603', '001612', '001621', '001630', '001639', '001648', '001657', '001666',
                        '001675', '001684', '001693', '001702', '001711', '001720', '001729', '001738',
                        '001747', '001756', '001765', '001774', '001783', '001792', '001801', '001810',
                        '001819', '001828', '001837', '001846', '001855', '001864', '001873', '001882',
                        '001891', '001900', '001909', '001918', '001927', '001936', '001945', '001954',
                        '001963', '001972', '001981', '001990', '001999'
                    ]
                },
                roundabout: {
                    folder: 'timelapse_roundabout',
                    frames: [
                        '000001', '000008', '000015', '000022', '000029', '000036', '000043', '000050',
                        '000057', '000064', '000071', '000078', '000085', '000092', '000099', '000106',
                        '000113', '000120', '000127', '000134', '000141', '000148', '000155', '000162',
                        '000169', '000176', '000183', '000190', '000197', '000204', '000211', '000218',
                        '000225', '000232', '000239', '000246', '000253', '000260', '000267', '000274',
                        '000281', '000288', '000295', '000302', '000309', '000316', '000323', '000330',
                        '000337', '000344', '000351', '000358', '000365', '000372', '000379', '000386',
                        '000393', '000400', '000407', '000414', '000421', '000428', '000435', '000442',
                        '000449', '000456', '000463', '000470', '000477', '000484', '000491', '000498',
                        '000505', '000512', '000519', '000526', '000533', '000540', '000547', '000554',
                        '000561', '000568', '000575', '000582', '000589', '000596', '000603', '000610',
                        '000617', '000624', '000631', '000638', '000645', '000652', '000659', '000666',
                        '000673', '000680', '000687', '000694', '000701', '000708', '000715', '000722',
                        '000729', '000736', '000743', '000750', '000757', '000764', '000771', '000778',
                        '000785', '000792', '000799', '000806', '000813', '000820', '000827', '000834',
                        '000841', '000848', '000855', '000862', '000869', '000876', '000883', '000890',
                        '000897', '000904', '000911', '000918', '000925', '000932', '000939', '000946',
                        '000953', '000960', '000967', '000974', '000981', '000988', '000995', '001002',
                        '001009', '001016', '001023', '001030', '001037', '001044', '001051', '001058',
                        '001065', '001072', '001079', '001086', '001093', '001100', '001107', '001114',
                        '001121', '001128', '001135', '001142', '001149', '001156', '001163', '001170',
                        '001177', '001184', '001191', '001198', '001205', '001212', '001219', '001226',
                        '001233', '001240', '001247', '001254', '001261', '001268', '001275', '001282',
                        '001289', '001296', '001303', '001310', '001317', '001324', '001331', '001338',
                        '001345', '001352', '001359', '001366', '001373', '001380', '001387', '001394',
                        '001401', '001408', '001415', '001422', '001429', '001436', '001443', '001450',
                        '001457', '001464', '001471', '001478', '001485', '001492', '001499', '001506',
                        '001513', '001520', '001527', '001534', '001541', '001548', '001555', '001562',
                        '001569', '001576', '001583', '001590', '001597', '001604', '001611', '001618',
                        '001625', '001632', '001639', '001646', '001653', '001660', '001667', '001674',
                        '001681', '001688', '001695', '001702', '001709', '001716', '001723', '001730',
                        '001737', '001744', '001751', '001758', '001765', '001772', '001779', '001786',
                        '001793', '001800', '001807', '001814', '001821', '001828', '001835', '001842',
                        '001849', '001856', '001863', '001870', '001877', '001884', '001891', '001898',
                        '001905', '001912', '001919', '001926', '001933', '001940', '001947', '001954',
                        '001961', '001968', '001975', '001982', '001989', '001996'
                    ]
                }
            };

            let currentTimelapse = 'kjevik';
            let images = [];
            let loadedCount = 0;
            let totalFrames = 0;
            let currentFrame = 0;
            let animationTimeout = null;
            let isPlaying = true;
            let isUserControlling = false;
            
            // Preload cache for all timelapses
            const preloadedImages = {};
            const preloadStatus = {};

            // Preload all timelapses upfront
            function preloadAllTimelapses() {
                Object.keys(timelapses).forEach(timelapseName => {
                    const timelapse = timelapses[timelapseName];
                    preloadedImages[timelapseName] = [];
                    preloadStatus[timelapseName] = { loaded: 0, total: timelapse.frames.length };
                    
                    timelapse.frames.forEach((frame) => {
                        const img = new Image();
                        img.src = `figs/${timelapse.folder}/frame_${frame}.png`;
                        img.onload = () => {
                            preloadStatus[timelapseName].loaded++;
                        };
                        img.onerror = () => {
                            console.warn(`Failed to preload ${timelapseName} frame_${frame}.png`);
                            preloadStatus[timelapseName].loaded++;
                        };
                        preloadedImages[timelapseName].push(img);
                    });
                });
            }

            function loadTimelapse(timelapseName) {
                // Stop current animation
                if (animationTimeout) {
                    clearTimeout(animationTimeout);
                    animationTimeout = null;
                }
                
                const timelapse = timelapses[timelapseName];
                if (!timelapse) return;
                
                currentTimelapse = timelapseName;
                
                // Use preloaded images if available
                if (preloadedImages[timelapseName] && preloadedImages[timelapseName].length > 0) {
                    images = preloadedImages[timelapseName];
                    totalFrames = timelapse.frames.length;
                    totalFramesCount = totalFrames;
                    currentFrame = 0;
                    isPlaying = true;
                    isUserControlling = false;
                    
                    // Update active option
                    timelapseOptions.forEach(opt => {
                        opt.classList.toggle('active', opt.dataset.timelapse === timelapseName);
                    });
                    
                    // Check if images are already loaded
                    const status = preloadStatus[timelapseName];
                    if (status && status.loaded === status.total) {
                        timelapseImg.classList.add('loaded');
                        timelapseSlider.max = totalFrames - 1;
                        updateFrameInfo();
                        startTimelapse();
                    } else {
                        // Wait for preload to complete
                        timelapseImg.classList.remove('loaded');
                        const checkInterval = setInterval(() => {
                            if (preloadStatus[timelapseName].loaded === preloadStatus[timelapseName].total) {
                                clearInterval(checkInterval);
                                timelapseImg.classList.add('loaded');
                                timelapseSlider.max = totalFrames - 1;
                                updateFrameInfo();
                                startTimelapse();
                            }
                        }, 50);
                    }
                } else {
                    // Fallback: load on demand if preload hasn't started
                    images = [];
                    loadedCount = 0;
                    totalFrames = timelapse.frames.length;
                    totalFramesCount = totalFrames;
                    currentFrame = 0;
                    isPlaying = true;
                    isUserControlling = false;
                    timelapseImg.classList.remove('loaded');
                    
                    // Update active option
                    timelapseOptions.forEach(opt => {
                        opt.classList.toggle('active', opt.dataset.timelapse === timelapseName);
                    });
                    
                    // Preload images
                    timelapse.frames.forEach((frame) => {
                        const img = new Image();
                        img.src = `figs/${timelapse.folder}/frame_${frame}.png`;
                        img.onload = () => {
                            loadedCount++;
                            if (loadedCount === totalFrames) {
                                timelapseImg.classList.add('loaded');
                                timelapseSlider.max = totalFrames - 1;
                                updateFrameInfo();
                                startTimelapse();
                            }
                        };
                        img.onerror = () => {
                            console.warn(`Failed to load frame_${frame}.png`);
                            loadedCount++;
                            if (loadedCount === totalFrames) {
                                timelapseImg.classList.add('loaded');
                                timelapseSlider.max = totalFrames - 1;
                                updateFrameInfo();
                                startTimelapse();
                            }
                        };
                        images.push(img);
                    });
                }
            }

            function updateFrameInfo() {
                if (timelapseFrameInfo) {
                    timelapseFrameInfo.textContent = `Frame ${currentFrame + 1} / ${totalFrames}`;
                }
            }

            function showFrame(frameIndex) {
                if (frameIndex >= 0 && frameIndex < totalFrames) {
                    timelapseImg.src = images[frameIndex].src;
                    currentFrame = frameIndex;
                    timelapseSlider.value = frameIndex;
                    updateFrameInfo();
                }
            }

            const totalDuration = 3000; // 3 seconds total for all timelapses
            let totalFramesCount = 0;
            
            // Calculate variable frame durations: slower at start, faster at end
            // Adjusted to ensure all timelapses take the same total duration
            function getFrameDuration(frameIndex) {
                const progress = frameIndex / totalFramesCount; // 0 to 1
                // Calculate base durations that scale with total frames to maintain consistent total time
                // For fewer frames, each frame gets more time; for more frames, less time
                const avgDuration = totalDuration / totalFramesCount;
                // Start slower (1.5x average), end faster (0.5x average)
                const startDuration = avgDuration * 1.5;
                const endDuration = avgDuration * 0.5;
                const easing = Math.pow(progress, 0.5); // Square root easing for smooth acceleration
                return startDuration - (startDuration - endDuration) * easing;
            }

            function startTimelapse() {
                function showNextFrame() {
                    if (!isPlaying || isUserControlling) return;
                    
                    currentFrame = (currentFrame + 1) % totalFramesCount; // Loop back to 0
                    showFrame(currentFrame);
                    
                    const frameIndex = currentFrame;
                    const duration = getFrameDuration(frameIndex);
                    animationTimeout = setTimeout(showNextFrame, duration);
                }

                // Show first frame immediately
                showFrame(0);
                // Start animation
                const duration = getFrameDuration(0);
                animationTimeout = setTimeout(showNextFrame, duration);
            }

            // Slider control
            timelapseSlider.addEventListener('input', (e) => {
                isUserControlling = true;
                const frameIndex = parseInt(e.target.value);
                showFrame(frameIndex);
            });

            timelapseSlider.addEventListener('mouseup', () => {
                // Resume animation after a short delay
                setTimeout(() => {
                    isUserControlling = false;
                    if (isPlaying) {
                        if (animationTimeout) clearTimeout(animationTimeout);
                        const duration = getFrameDuration(currentFrame);
                        animationTimeout = setTimeout(() => {
                            function continueAnimation() {
                                if (!isPlaying || isUserControlling) return;
                                currentFrame = (currentFrame + 1) % totalFramesCount;
                                showFrame(currentFrame);
                                const duration = getFrameDuration(currentFrame);
                                animationTimeout = setTimeout(continueAnimation, duration);
                            }
                            continueAnimation();
                        }, duration);
                    }
                }, 500);
            });

            // Pause/resume on click
            timelapseImg.addEventListener('click', () => {
                isPlaying = !isPlaying;
                if (isPlaying && !isUserControlling) {
                    if (animationTimeout) clearTimeout(animationTimeout);
                    function continueAnimation() {
                        if (!isPlaying || isUserControlling) return;
                        currentFrame = (currentFrame + 1) % totalFramesCount;
                        showFrame(currentFrame);
                        const duration = getFrameDuration(currentFrame);
                        animationTimeout = setTimeout(continueAnimation, duration);
                    }
                    const duration = getFrameDuration(currentFrame);
                    animationTimeout = setTimeout(continueAnimation, duration);
                } else if (!isPlaying) {
                    if (animationTimeout) clearTimeout(animationTimeout);
                }
            });

            // Timelapse selector
            timelapseOptions.forEach(option => {
                option.addEventListener('click', () => {
                    const timelapseName = option.dataset.timelapse;
                    if (timelapseName !== currentTimelapse) {
                        loadTimelapse(timelapseName);
                    }
                });
            });

            // Preload all timelapses upfront
            preloadAllTimelapses();
            
            // Load initial timelapse
            loadTimelapse('kjevik');
        }

        // Method view toggle (video/figure)
        function switchMethodView(view) {
            const videoContainer = document.getElementById('method-video-container');
            const figureContainer = document.getElementById('method-figure-container');
            const videoBtn = document.getElementById('method-toggle-video');
            const figureBtn = document.getElementById('method-toggle-figure');
            
            if (view === 'video') {
                videoContainer.style.display = 'block';
                figureContainer.style.display = 'none';
                videoBtn.classList.add('active');
                figureBtn.classList.remove('active');
                videoBtn.style.background = 'var(--primary)';
                videoBtn.style.color = 'white';
                videoBtn.style.borderColor = 'var(--primary)';
                figureBtn.style.background = 'white';
                figureBtn.style.color = 'var(--primary)';
                figureBtn.style.borderColor = '#e5e7eb';
            } else {
                videoContainer.style.display = 'none';
                figureContainer.style.display = 'block';
                videoBtn.classList.remove('active');
                figureBtn.classList.add('active');
                figureBtn.style.background = 'var(--primary)';
                figureBtn.style.color = 'white';
                figureBtn.style.borderColor = 'var(--primary)';
                videoBtn.style.background = 'white';
                videoBtn.style.color = 'var(--primary)';
                videoBtn.style.borderColor = '#e5e7eb';
            }
        }

        // Uncertainty carousel
        let currentUncertaintySlide = 0;
        const totalUncertaintySlides = 4;

        function updateUncertaintyCarousel() {
            const imagesContainer = document.getElementById('uncertainty-images');
            const dots = document.querySelectorAll('.uncertainty-dot');
            
            imagesContainer.style.transform = `translateX(-${currentUncertaintySlide * 100}%)`;
            
            dots.forEach((dot, index) => {
                if (index === currentUncertaintySlide) {
                    dot.classList.add('active');
                    dot.style.background = 'var(--primary)';
                } else {
                    dot.classList.remove('active');
                    dot.style.background = '#d1d5db';
                }
            });
        }

        function changeUncertaintySlide(direction) {
            currentUncertaintySlide += direction;
            if (currentUncertaintySlide < 0) {
                currentUncertaintySlide = totalUncertaintySlides - 1;
            } else if (currentUncertaintySlide >= totalUncertaintySlides) {
                currentUncertaintySlide = 0;
            }
            updateUncertaintyCarousel();
        }

        function goToUncertaintySlide(index) {
            currentUncertaintySlide = index;
            updateUncertaintyCarousel();
        }

        // Qualitative examples carousel
        let currentQualitativeSlide = 0;
        const totalQualitativeSlides = 3;

        function updateQualitativeCarousel() {
            const imagesContainer = document.getElementById('qualitative-images');
            const dots = document.querySelectorAll('.qualitative-dot');
            const caption = document.getElementById('qualitative-caption');
            
            imagesContainer.style.transform = `translateX(-${currentQualitativeSlide * 100}%)`;
            
            const factors = ['×2', '×4', '×8'];
            if (caption) {
                caption.textContent = `Upsampling Factor: ${factors[currentQualitativeSlide]}`;
            }
            
            dots.forEach((dot, index) => {
                if (index === currentQualitativeSlide) {
                    dot.classList.add('active');
                    dot.style.background = 'var(--primary)';
                } else {
                    dot.classList.remove('active');
                    dot.style.background = '#d1d5db';
                }
            });
        }

        function changeQualitativeSlide(direction) {
            currentQualitativeSlide += direction;
            if (currentQualitativeSlide < 0) {
                currentQualitativeSlide = totalQualitativeSlides - 1;
            } else if (currentQualitativeSlide >= totalQualitativeSlides) {
                currentQualitativeSlide = 0;
            }
            updateQualitativeCarousel();
        }

        function goToQualitativeSlide(index) {
            currentQualitativeSlide = index;
            updateQualitativeCarousel();
        }

        // Carousel state
        let sequenceCarouselPos = {
            interactive: 0,
            slider: 0
        };
        
        // Reset carousel positions on load
        function resetSequenceCarousel() {
            const interactiveContainer = document.getElementById('burst-sequence-interactive')?.querySelector('.burst-sequence-container');
            const sliderContainer = document.getElementById('burst-sequence-slider')?.querySelector('.burst-sequence-container');
            
            if (interactiveContainer) {
                interactiveContainer.style.transform = 'translateX(0px)';
            }
            if (sliderContainer) {
                sliderContainer.style.transform = 'translateX(0px)';
            }
            
            sequenceCarouselPos.interactive = 0;
            sequenceCarouselPos.slider = 0;
        }

        // Sequence view toggle (interactive/slider)
        function switchSequenceView(view) {
            const interactiveView = document.getElementById('burst-sequence-interactive');
            const sliderView = document.getElementById('burst-sequence-slider');
            const interactiveBtn = document.getElementById('sequence-toggle-interactive');
            const sliderBtn = document.getElementById('sequence-toggle-slider');
            const instructions = document.getElementById('sequence-instructions');
            
            if (view === 'slider') {
                interactiveView.style.display = 'none';
                sliderView.style.display = 'block';
                interactiveBtn.classList.remove('active');
                sliderBtn.classList.add('active');
                interactiveBtn.style.background = 'white';
                interactiveBtn.style.color = 'var(--primary)';
                interactiveBtn.style.borderColor = '#e5e7eb';
                sliderBtn.style.background = 'var(--primary)';
                sliderBtn.style.color = 'white';
                sliderBtn.style.borderColor = 'var(--primary)';
                if (instructions) {
                    instructions.textContent = 'Drag the slider to compare the low-resolution input (left) with the super-resolved output (right).';
                }
                updateSequenceNavButtons('slider');
            } else {
                interactiveView.style.display = 'block';
                sliderView.style.display = 'none';
                sliderBtn.classList.remove('active');
                interactiveBtn.classList.add('active');
                sliderBtn.style.background = 'white';
                sliderBtn.style.color = 'var(--primary)';
                sliderBtn.style.borderColor = '#e5e7eb';
                interactiveBtn.style.background = 'var(--primary)';
                interactiveBtn.style.color = 'white';
                interactiveBtn.style.borderColor = 'var(--primary)';
                if (instructions) {
                    instructions.textContent = 'Each tile loops through the LR burst automatically. Hover (or focus) to freeze on our base LR frame, then press / long-press to show the SuperF SR output. Let go to resume the LR sequence.';
                }
                updateSequenceNavButtons('interactive');
            }
        }

        // Navigate carousel
        function navigateSequence(view, direction) {
            const viewElement = document.getElementById(`burst-sequence-${view}`);
            if (!viewElement) return;
            
            const container = viewElement.querySelector('.burst-sequence-container');
            if (!container) return;
            
            const cards = container.querySelectorAll('.sequence-card');
            const totalCards = cards.length;
            const cardsPerView = 3; // Show 3 items at a time
            const maxPosition = Math.max(0, totalCards - cardsPerView);
            
            sequenceCarouselPos[view] += direction;
            if (sequenceCarouselPos[view] < 0) sequenceCarouselPos[view] = 0;
            if (sequenceCarouselPos[view] > maxPosition) sequenceCarouselPos[view] = maxPosition;
            
            // Calculate translate: each card width + gap (32px)
            if (cards.length > 0 && cards[0]) {
                const firstCard = cards[0];
                const cardRect = firstCard.getBoundingClientRect();
                const cardWidth = cardRect.width;
                const gap = 32; // Match the gap in CSS
                const translateX = -sequenceCarouselPos[view] * (cardWidth + gap);
                container.style.transform = `translateX(${translateX}px)`;
            }
            
            updateSequenceNavButtons(view);
        }

        // Update navigation button states
        function updateSequenceNavButtons(view) {
            const viewElement = document.getElementById(`burst-sequence-${view}`);
            if (!viewElement) return;
            
            const prevBtn = viewElement.querySelector('.sequence-nav-btn.prev');
            const nextBtn = viewElement.querySelector('.sequence-nav-btn.next');
            const container = viewElement.querySelector('.burst-sequence-container');
            const cards = container.querySelectorAll('.sequence-card');
            const totalCards = cards.length;
            const cardsPerView = 3; // Show 3 items at a time
            const maxPosition = Math.max(0, totalCards - cardsPerView);
            
            // Hide navigation buttons if all items fit on screen
            if (totalCards <= cardsPerView) {
                if (prevBtn) prevBtn.style.display = 'none';
                if (nextBtn) nextBtn.style.display = 'none';
            } else {
                // Show buttons when navigation is possible
                if (prevBtn) {
                    prevBtn.disabled = sequenceCarouselPos[view] === 0;
                    prevBtn.style.display = 'flex';
                }
                if (nextBtn) {
                    nextBtn.disabled = sequenceCarouselPos[view] >= maxPosition;
                    nextBtn.style.display = 'flex';
                }
            }
        }

        // Slider update function
        function updateSlider(slider, sequenceId) {
            const value = slider.value;
            const container = slider.closest('.slider-container');
            const srImage = container.querySelector('.slider-sr');
            const divider = container.querySelector('.slider-divider');
            
            if (srImage) {
                srImage.style.clipPath = `inset(0 ${100 - value}% 0 0)`;
            }
            if (divider) {
                divider.style.left = `${value}%`;
            }
        }

        // Burst sequence interaction (hover to base frame, press to reveal HR)
        function initBurstSequence() {
            const sequences = {
                cph: {
                    frames: [
                        'figs/cph/2025-04-03_S2B_33UUB_20250403_0_L2A.png',
                        'figs/cph/2025-04-07_S2A_33UUB_20250407_0_L2A.png',
                        'figs/cph/2025-04-10_S2B_33UUB_20250410_0_L2A.png',
                        'figs/cph/2025-04-27_S2A_33UUB_20250427_0_L2A.png',
                        'figs/cph/2025-05-08_S2C_33UUB_20250508_0_L2A.png',
                        'figs/cph/2025-05-15_S2C_33UUB_20250515_0_L2A.png',
                        'figs/cph/2025-06-19_S2B_33UUB_20250619_0_L2A.png'
                    ],
                    base: 'figs/cph/2025-05-08_S2C_33UUB_20250508_0_L2A.png',
                    sr: 'figs/cph/sr_sample_000.png',
                    interval: 420
                },
                circle: {
                    frames: [
                        'figs/circle/2025-04-02_S2A_30STG_20250402_1_L2A.png',
                        'figs/circle/2025-04-25_S2B_30STG_20250425_0_L2A.png',
                        'figs/circle/2025-05-10_S2C_30STG_20250510_0_L2A.png',
                        'figs/circle/2025-05-20_S2C_30STG_20250520_0_L2A.png',
                        'figs/circle/2025-05-25_S2B_30STG_20250525_0_L2A.png',
                        'figs/circle/2025-06-04_S2B_30STG_20250604_0_L2A.png',
                        'figs/circle/2025-06-11_S2A_30STG_20250611_1_L2A.png',
                        'figs/circle/2025-06-29_S2C_30STG_20250629_0_L2A.png'
                    ],
                    base: 'figs/circle/2025-05-10_S2C_30STG_20250510_0_L2A.png',
                    sr: 'figs/circle/sr_sample_000.png',
                    interval: 420
                },
                roundabout: {
                    frames: [
                        'figs/roundabout/2025-04-17_S2C_17RMP_20250417_0_L2A.png',
                        'figs/roundabout/2025-05-09_S2A_17RMP_20250509_0_L2A.png',
                        'figs/roundabout/2025-05-17_S2C_17RMP_20250517_0_L2A.png',
                        'figs/roundabout/2025-05-22_S2B_17RMP_20250522_0_L2A.png',
                        'figs/roundabout/2025-05-27_S2C_17RMP_20250527_0_L2A.png',
                        'figs/roundabout/2025-06-01_S2B_17RMP_20250601_0_L2A.png'
                    ],
                    base: 'figs/roundabout/2025-05-17_S2C_17RMP_20250517_0_L2A.png',
                    sr: 'figs/roundabout/sr_sample_000.png',
                    interval: 420
                },
                island: {
                    frames: [
                        'figs/island/2025-02-06_S2B_48PUV_20250206_0_L2A.png',
                        'figs/island/2025-02-11_S2C_48PUV_20250211_0_L2A.png',
                        'figs/island/2025-03-23_S2C_48PUV_20250323_0_L2A.png',
                        'figs/island/2025-03-25_S2A_48PUV_20250325_0_L2A.png',
                        'figs/island/2025-03-28_S2B_48PUV_20250328_0_L2A.png',
                        'figs/island/2025-04-12_S2C_48PUV_20250412_0_L2A.png',
                        'figs/island/2025-04-27_S2B_48PUV_20250427_0_L2A.png',
                        'figs/island/2025-05-17_S2B_48PUV_20250517_0_L2A.png'
                    ],
                    base: 'figs/island/2025-04-12_S2C_48PUV_20250412_0_L2A.png',
                    sr: 'figs/island/sr_sample_000.png',
                    interval: 420
                },
                kjevik: {
                    frames: [
                        'figs/kjevik/2025-04-01_S2C_32VMK_20250401_0_L2A.png',
                        'figs/kjevik/2025-04-03_S2A_32VMK_20250403_0_L2A.png',
                        'figs/kjevik/2025-04-04_S2C_32VMK_20250404_0_L2A.png',
                        'figs/kjevik/2025-04-06_S2A_32VMK_20250406_1_L2A.png',
                        'figs/kjevik/2025-04-06_S2B_32VMK_20250406_0_L2A.png',
                        'figs/kjevik/2025-04-09_S2B_32VMK_20250409_0_L2A.png',
                        'figs/kjevik/2025-04-26_S2A_32VMK_20250426_1_L2A.png',
                        'figs/kjevik/2025-04-26_S2B_32VMK_20250426_0_L2A.png',
                        'figs/kjevik/2025-04-29_S2B_32VMK_20250429_0_L2A.png',
                        'figs/kjevik/2025-05-01_S2C_32VMK_20250501_0_L2A.png',
                        'figs/kjevik/2025-05-06_S2A_32VMK_20250506_1_L2A.png',
                        'figs/kjevik/2025-05-06_S2B_32VMK_20250506_0_L2A.png',
                        'figs/kjevik/2025-05-11_S2C_32VMK_20250511_0_L2A.png',
                        'figs/kjevik/2025-05-13_S2A_32VMK_20250513_0_L2A.png',
                        'figs/kjevik/2025-05-16_S2A_32VMK_20250516_2_L2A.png',
                        'figs/kjevik/2025-05-19_S2B_32VMK_20250519_0_L2A.png',
                        'figs/kjevik/2025-05-31_S2C_32VMK_20250531_0_L2A.png',
                        'figs/kjevik/2025-06-12_S2A_32VMK_20250612_0_L2A.png',
                        'figs/kjevik/2025-06-25_S2A_32VMK_20250625_1_L2A.png',
                        'figs/kjevik/2025-06-25_S2B_32VMK_20250625_0_L2A.png',
                        'figs/kjevik/2025-06-30_S2C_32VMK_20250630_0_L2A.png'
                    ],
                    base: 'figs/kjevik/2025-05-06_S2A_32VMK_20250506_1_L2A.png',
                    sr: 'figs/kjevik/sr_sample_000.png',
                    interval: 420
                }
            };

            const displays = document.querySelectorAll('.sequence-display');
            if (!displays.length) return;

            displays.forEach((display) => {
                const key = display.dataset.sequence;
                const sequence = sequences[key];
                if (!sequence) return;

                const imgEl = display.querySelector('.sequence-img');
                const labelEl = display.querySelector('.sequence-label');

                let loopTimer = null;
                let hoverActive = false;
                let isPressed = false;
                let frameIndex = 0;

                const setLabel = (text) => {
                    if (labelEl) labelEl.textContent = text;
                };

                const showImage = (src) => {
                    if (!imgEl) return;
                    if (imgEl.dataset.currentSrc === src) return;
                    imgEl.dataset.currentSrc = src;
                    imgEl.src = src;
                };

                const stopLoop = () => {
                    if (loopTimer) {
                        clearInterval(loopTimer);
                        loopTimer = null;
                    }
                };

                const startLoop = () => {
                    stopLoop();
                    setLabel('LR Sequence');
                    frameIndex = 0;
                    showImage(sequence.frames[frameIndex]);

                    if (sequence.frames.length <= 1) return;

                    loopTimer = setInterval(() => {
                        frameIndex = (frameIndex + 1) % sequence.frames.length;
                        showImage(sequence.frames[frameIndex]);
                    }, sequence.interval || 350);
                };

                const showBaseFrame = () => {
                    stopLoop();
                    setLabel('Base Frame');
                    showImage(sequence.base);
                };

                const showSR = () => {
                    stopLoop();
                    setLabel('SR Output');
                    showImage(sequence.sr);
                };

                const resumeAppropriateState = () => {
                    if (hoverActive) {
                        showBaseFrame();
                    } else {
                        startLoop();
                    }
                };

                startLoop();

                display.addEventListener('mouseenter', () => {
                    hoverActive = true;
                    if (!isPressed) showBaseFrame();
                });

                display.addEventListener('mouseleave', () => {
                    hoverActive = false;
                    if (!isPressed) startLoop();
                });

                display.addEventListener('focus', () => {
                    hoverActive = true;
                    if (!isPressed) showBaseFrame();
                });

                display.addEventListener('blur', () => {
                    hoverActive = false;
                    if (!isPressed) startLoop();
                });

                const handlePressStart = (event) => {
                    if (event) {
                        event.preventDefault();
                        if (typeof event.pointerId !== 'undefined') {
                            display.setPointerCapture(event.pointerId);
                        }
                    }
                    if (isPressed) return;
                    isPressed = true;
                    display.classList.add('is-pressed');
                    display.setAttribute('aria-pressed', 'true');
                    showSR();
                };

                const handlePressEnd = (event) => {
                    if (!isPressed) return;
                    if (event && typeof event.pointerId !== 'undefined' && display.hasPointerCapture(event.pointerId)) {
                        display.releasePointerCapture(event.pointerId);
                    }
                    isPressed = false;
                    display.classList.remove('is-pressed');
                    display.setAttribute('aria-pressed', 'false');
                    resumeAppropriateState();
                };

                display.addEventListener('pointerdown', handlePressStart);
                display.addEventListener('pointerup', handlePressEnd);
                display.addEventListener('pointercancel', handlePressEnd);
                display.addEventListener('contextmenu', (e) => e.preventDefault());

                display.addEventListener('keydown', (e) => {
                    if (e.code === 'Space' || e.code === 'Enter') {
                        handlePressStart(e);
                    }
                });

                display.addEventListener('keyup', (e) => {
                    if (e.code === 'Space' || e.code === 'Enter') {
                        handlePressEnd(e);
                    }
                });
            });
        }

        // Initialize
        // Abstract toggle text update
        function initAbstractToggle() {
            const abstractDetails = document.querySelector('#abstract details');
            const abstractToggleText = document.getElementById('abstract-toggle-text');
            
            if (abstractDetails && abstractToggleText) {
                // Set initial text based on whether details is open
                abstractToggleText.textContent = abstractDetails.open ? 'Hide abstract' : 'Show abstract';
                
                // Listen for toggle events
                abstractDetails.addEventListener('toggle', () => {
                    abstractToggleText.textContent = abstractDetails.open ? 'Hide abstract' : 'Show abstract';
                });
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            initBurstSequence();                    // For LR sequence interaction
            updateUncertaintyCarousel();            // Initialize uncertainty carousel
            updateQualitativeCarousel();            // Initialize qualitative carousel
            initAbstractToggle();                    // Initialize abstract toggle text
            resetSequenceCarousel();                 // Reset carousel to show all items
            updateSequenceNavButtons('interactive'); // Initialize sequence carousel buttons
            updateSequenceNavButtons('slider');      // Initialize sequence carousel buttons
        });
    </script>
</body>
</html>